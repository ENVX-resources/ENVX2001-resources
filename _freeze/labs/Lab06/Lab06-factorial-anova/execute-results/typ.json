{
  "hash": "4e430c937707be286b03aa288571452f",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Lab 6 - Factorial Designs\"\n# revised-by:\nsubtitle: ENVX2001 Applied Statistical Methods\ndescription: The University of Sydney\ndate: today\ndate-format: \"[Semester 1,] YYYY\"\nresources:\n  - data/Data6.xlsx\n---\n\n:::{.callout-tip}\n## Learning outcomes\nAt the end of this practical students should be able to:\n\n* use R to analyse experiments with a factorial treatment structure where the experimental design is a CRD or RCBD;\n\nAll of the data for this practical is in the **Data6.xlsx** file.\n\n:::\n\n\n## Exercise 1 - More Treatment Structures (Walk-through)\nA microbiologist conducted an experiment to assess the survival of *Salmonella typhinerium* when subjected to various treatments.  A factorial treatment design was used, the treatments being various combinations of sorbic acid, pH, and water activity.  The density of Salmonella seven days after the treatment began was recorded.  The Salmonella data is in the form:\n\n$$log_{e}(density/ml)$$, to 2 decimal places.  \n\nThe data is found in the **Salmonella** sheet in the **Data6.xlsx** file.\n\nThere is a slight **trick** to analysing this experiment which will improve your ability to analyse factorial experiments in general.\n\nThe table below shows you how to specify the treatment structure and individual interaction term in a factorial design involving 2 factors, `A` and `B`. \n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|term              |command |\n|:-----------------|:-------|\n|2-way factorial   |A*B     |\n|2-way interaction |A:B     |\n\n\n:::\n:::\n\n\n::: {.question}\n### Question 1.1\n*(i)* Import the data into R and describe the data using numerical and graphical summaries.  In particular does the exploratory data analysis (EDA) show any difference in *S.typhinerium* density between the levels of each of the treatment factors (a) sorbic acid (b) pH (c) water activity?  Is there evidence of an interaction using interaction plots.  No need to look at marginal means as the interaction plots summarise these.\n:::\n\n::: {.callout-tip}\nSome hints for the EDA are:\n\n* in many experiments we will have treatment factors which have a numerical value (as is the case here) but for ANOVA-type problems we are comparing the mean response between each value so we need to tell R the data type is a `factor`.  If we don't, it will fit a regression model which is Topics 7-9.  This will result in the wrong type of analysis.\n\n* use the `tapply` function in conjunction with the `summary` function;\n\n* boxplots for individual levels of a factor are likely to be the most informative as compared to numerical summaries they visually show the spread of the observations as well.  Example R code is below.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nboxplot(Density~pH,data=salm)\n```\n:::\n\n\n* to create interaction plots use the `interaction.plot` or `emmip` function. You will need one of these for each 2-way interaction in your model.\n\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#\n```\n:::\n\n\n::: {.content-visible when-profile=\"solution\"}\n::: {.ans}\n### Solution\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readxl)\nsalm<-read_excel(\"data/Data6.xlsx\",sheet=\"Salmonella\")\nstr(salm)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ntibble [45 × 4] (S3: tbl_df/tbl/data.frame)\n $ Sorbic.Acid: num [1:45] 0 0 0 100 100 100 200 200 200 0 ...\n $ pH         : num [1:45] 5 5.5 6 5 5.5 6 5 5.5 6 5 ...\n $ Activity   : num [1:45] 0.78 0.78 0.78 0.78 0.78 0.78 0.78 0.78 0.78 0.82 ...\n $ Density    : num [1:45] 4.2 4.34 4.31 4.18 4.39 4.13 4.15 4.12 3.93 4.52 ...\n```\n\n\n:::\n\n```{.r .cell-code}\nsalm$Sorbic.Acid<-as.factor(salm$Sorbic.Acid)\nsalm$pH<-as.factor(salm$pH)\nsalm$Activity<-as.factor(salm$Activity)\nstr(salm)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ntibble [45 × 4] (S3: tbl_df/tbl/data.frame)\n $ Sorbic.Acid: Factor w/ 3 levels \"0\",\"100\",\"200\": 1 1 1 2 2 2 3 3 3 1 ...\n $ pH         : Factor w/ 3 levels \"5\",\"5.5\",\"6\": 1 2 3 1 2 3 1 2 3 1 ...\n $ Activity   : Factor w/ 5 levels \"0.78\",\"0.82\",..: 1 1 1 1 1 1 1 1 1 2 ...\n $ Density    : num [1:45] 4.2 4.34 4.31 4.18 4.39 4.13 4.15 4.12 3.93 4.52 ...\n```\n\n\n:::\n:::\n\n\nFirst we calculate summary statistics for different levels of each treatment factor.\n\n::: {.cell}\n\n```{.r .cell-code}\ntapply(salm$Density,salm$Sorbic.Acid,summary)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$`0`\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  4.200   4.430   5.060   5.303   6.060   6.700 \n\n$`100`\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  4.130   4.290   4.850   4.999   5.530   6.520 \n\n$`200`\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  3.930   4.265   4.410   4.891   5.315   6.430 \n```\n\n\n:::\n\n```{.r .cell-code}\ntapply(salm$Density,salm$pH,summary)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$`5`\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  4.150   4.245   4.790   5.082   5.960   6.510 \n\n$`5.5`\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  4.120   4.365   4.950   5.066   5.665   6.700 \n\n$`6`\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  3.930   4.300   4.850   5.045   5.535   6.650 \n```\n\n\n:::\n\n```{.r .cell-code}\ntapply(salm$Density,salm$Activity,summary)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$`0.78`\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  3.930   4.130   4.180   4.194   4.310   4.390 \n\n$`0.82`\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  4.180   4.270   4.310   4.387   4.430   4.850 \n\n$`0.86`\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   4.29    4.41    4.85    4.79    5.01    5.35 \n\n$`0.9`\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  5.010   5.200   5.430   5.532   5.870   6.140 \n\n$`0.94`\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  6.180   6.250   6.430   6.418   6.520   6.700 \n```\n\n\n:::\n:::\n\nThere are a lot of statistics to examine which is where graphical summaries are easier to interpret.\n\nThe boxplots for each level of `Sorbic.Acid` show that `Density` decreases as the `Sorbic.Acid` increases, this is based off the median values.  However it should be noted the distributions at each level do overlap each other which may indicate no significant differences.\n\n::: {.cell}\n\n```{.r .cell-code}\nboxplot(Density~Sorbic.Acid,data=salm,main=\" \",xlab=\"Sorbic Acid\",ylab=\"Density\")\n```\n\n::: {.cell-output-display}\n![](Lab06-factorial-anova_files/figure-typst/unnamed-chunk-6-1.png)\n:::\n:::\n\n\nThe boxplots for each level of `pH` show that there is little difference in `Density`, this is based off the median values.\n\n::: {.cell}\n\n```{.r .cell-code}\nboxplot(Density~pH,data=salm,main=\" \",xlab=\"pH\",ylab=\"Density\")\n```\n\n::: {.cell-output-display}\n![](Lab06-factorial-anova_files/figure-typst/unnamed-chunk-7-1.png)\n:::\n:::\n\n\nThe boxplots for each level of `Activity` show that `Density` increases as the `Activity` increases quite markedly, this is based off the median values. Also note the distributions for each level in some cases do not overlap at all, for example `0.78` and `0.82` are quite distinct from `0.9` and `0.94`.\n\n::: {.cell}\n\n```{.r .cell-code}\nboxplot(Density~Activity,data=salm,main=\" \",xlab=\"Activity\",ylab=\"Density\")\n```\n\n::: {.cell-output-display}\n![](Lab06-factorial-anova_files/figure-typst/unnamed-chunk-8-1.png)\n:::\n:::\n\n\nThere are three 2 factor interactions which we can explore with interaction plots.  When interpreting the interaction plots we are looking for changes in the shape of the lines for different levels of the treatment factor shown in the inset.\n\n::: {.cell}\n\n```{.r .cell-code}\ninteraction.plot(salm$Sorbic.Acid,salm$pH,salm$Density)\n```\n\n::: {.cell-output-display}\n![](Lab06-factorial-anova_files/figure-typst/unnamed-chunk-9-1.png)\n:::\n:::\n\n\nOr:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(emmeans)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWelcome to emmeans.\nCaution: You lose important information if you filter this package's results.\nSee '? untidy'\n```\n\n\n:::\n\n```{.r .cell-code}\nsalm.aov.2<-aov(Density~Sorbic.Acid*pH*Activity-Sorbic.Acid:pH:Activity,data=salm)\n\nemmip(salm.aov.2, pH ~ Sorbic.Acid, CIs = TRUE)\n```\n\n::: {.cell-output-display}\n![](Lab06-factorial-anova_files/figure-typst/unnamed-chunk-10-1.png)\n:::\n:::\n\n\n\nThe `pH` and `Sorbic.Acid` interaction plot does not have parallel lines, the difference being when `pH` = 5.  There may be an interaction here but formal hypothesis testing is needed to determine this.\n\n::: {.cell}\n\n```{.r .cell-code}\ninteraction.plot(salm$Sorbic.Acid,salm$Activity,salm$Density)\n```\n\n::: {.cell-output-display}\n![](Lab06-factorial-anova_files/figure-typst/unnamed-chunk-11-1.png)\n:::\n\n```{.r .cell-code}\n#Or\n\nemmip(salm.aov.2, Activity ~ Sorbic.Acid, CIs = TRUE)\n```\n\n::: {.cell-output-display}\n![](Lab06-factorial-anova_files/figure-typst/unnamed-chunk-11-2.png)\n:::\n:::\n\n\nThe `Activity` and `Sorbic.Acid` interaction plot does have parallel lines so there is not likely to be an interaction. Note that the traces for different `Activity` levels are quite well separated in most cases which is further evidence of a treatment effect for `Activity`.\n\n::: {.cell}\n\n```{.r .cell-code}\ninteraction.plot(salm$pH,salm$Activity,salm$Density)\n```\n\n::: {.cell-output-display}\n![](Lab06-factorial-anova_files/figure-typst/unnamed-chunk-12-1.png)\n:::\n\n```{.r .cell-code}\n#Or\n\n emmip(salm.aov.2, Activity ~ pH, CIs = TRUE)\n```\n\n::: {.cell-output-display}\n![](Lab06-factorial-anova_files/figure-typst/unnamed-chunk-12-2.png)\n:::\n:::\n\n\nThe `Activity` and `pH` interaction plot does have parallel lines so there is not likely to be an interaction. Note that the traces for different `Activity` levels are quite well separated in most cases which is further evidence of a treatment effect for `Activity`.\n:::\n:::\n\n::: {.question}\n### Question 1.2\n*(ii)* Write out the model you are fitting in terms of main effects and interactions, words are fine.  Note, that each of these will have an associated statistical hypotheses.  Obtain an ANOVA for these data, including appropriate interaction terms in the model.\n\nWhat do you notice in the ANOVA table when your run the full 3-way factorial ANOVA?  Use the `summary` function to extract the ANOVA table.\n\nRun the model again but only include the interactions involving two factors: **do not include the three factor interaction term**.  Why are we not including the three factor interaction?\n:::\n\n:::{.callout-tip}\nLook at the data in Excel and **manually** calculate the mean `Density` for when `pH` = 5.0, `Activity` = 0.78 and `Sorbic.Acid` = 0.  How many observations were used to calculate the mean?\n\n:::\n\nThe model in words is:\n\n::: {.content-visible when-profile=\"solution\"}\n::: {.ans}\n\n::: {.cell}\n\n```{.r .cell-code}\n#\n```\n:::\n\n\n\n### Solution\n\ndensity =  sorbic acid + pH + activity (main effects) + \n\nsorbic acid:pH + sorbic acid:activity + activity:pH (2  factor interactions) +\n\nsorbic acid:pH:activity (3 factor interaction)\n\n\nWe are not fitting the 3 factor interaction as there is no replication at that level.  For every combination of the three factors (`Sorbic.Acid`, `Activity` and `pH`), there is only one observation, so if this is fitted there will be zero degrees of freedom; replication would be needed to fit a three-way interaction.  Effectively, by not fitting a three factor interaction, this term, becomes the Residual term.\n\nTo illustrate compare the output from a model with and without the 3 factor interaction.\n\n::: {.cell}\n\n```{.r .cell-code}\nsalm.aov<-aov(Density~Sorbic.Acid*pH*Activity,data=salm)\nsummary(salm.aov)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                        Df Sum Sq Mean Sq\nSorbic.Acid              2  1.366   0.683\npH                       2  0.011   0.005\nActivity                 4 30.077   7.519\nSorbic.Acid:pH           4  0.209   0.052\nSorbic.Acid:Activity     8  0.501   0.063\npH:Activity              8  0.452   0.056\nSorbic.Acid:pH:Activity 16  0.635   0.040\n```\n\n\n:::\n\n```{.r .cell-code}\nsalm.aov.2<-aov(Density~Sorbic.Acid*pH*Activity-Sorbic.Acid:pH:Activity,data=salm)\nsummary(salm.aov.2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                     Df Sum Sq Mean Sq F value   Pr(>F)    \nSorbic.Acid           2  1.366   0.683  17.196 0.000103 ***\npH                    2  0.011   0.005   0.133 0.876834    \nActivity              4 30.077   7.519 189.367 2.96e-13 ***\nSorbic.Acid:pH        4  0.209   0.052   1.319 0.305270    \nSorbic.Acid:Activity  8  0.501   0.063   1.578 0.208120    \npH:Activity           8  0.452   0.056   1.422 0.260864    \nResiduals            16  0.635   0.040                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n:::\n:::\n\n::: {.question}\n### Question 1.3\n*(iii)* Test that the model assumptions have been met.\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#\n```\n:::\n\n\n\n::: {.content-visible when-profile=\"solution\"}\n::: {.ans}\n### Solution\nThe residual diagnostics show that the data is normally distributed, has constant variance and has no obvious outliers.  The response has been log transformed so this is no surprise.\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow=c(2,2))\nhist(rstandard(salm.aov.2))\nplot(salm.aov.2$fitted.values,(rstandard(salm.aov.2)))\nqqnorm(rstandard(salm.aov.2))\nabline(0,1)\n```\n\n::: {.cell-output-display}\n![](Lab06-factorial-anova_files/figure-typst/unnamed-chunk-16-1.png)\n:::\n:::\n\n\nor\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(performance)\ncheck_model(salm.aov.2)\n```\n\n::: {.cell-output-display}\n![](Lab06-factorial-anova_files/figure-typst/unnamed-chunk-17-1.png)\n:::\n:::\n\n:::\n:::\n\n::: {.question}\n### Question 1.4\n*(iv)* What are the significant effects in the model?  For the significant effects we conduct post-hoc tests the Tukey's Test to determine which pairs are significantly different. Write overall conclusions, in terms of the statistical hypothesis testing and in terms of the biological description of the experiment.\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#\n```\n:::\n\n\n::: {.content-visible when-profile=\"solution\"}\n::: {.ans}\n### Solution\nThe ANOVA shows that none of the 2 factor interactions are significant which means we can examine the main effects individually.  The significant effects are `pH` and `Sorbic.Acid` with P-values less than 0.05.\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(salm.aov.2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                     Df Sum Sq Mean Sq F value   Pr(>F)    \nSorbic.Acid           2  1.366   0.683  17.196 0.000103 ***\npH                    2  0.011   0.005   0.133 0.876834    \nActivity              4 30.077   7.519 189.367 2.96e-13 ***\nSorbic.Acid:pH        4  0.209   0.052   1.319 0.305270    \nSorbic.Acid:Activity  8  0.501   0.063   1.578 0.208120    \npH:Activity           8  0.452   0.056   1.422 0.260864    \nResiduals            16  0.635   0.040                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\nTukey test for the significant effects is shown below.\n\n::: {.cell}\n\n```{.r .cell-code}\nemmeans(salm.aov.2, pairwise ~ Sorbic.Acid)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nNOTE: Results may be misleading due to involvement in interactions\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$emmeans\n Sorbic.Acid emmean     SE df lower.CL upper.CL\n 0             5.30 0.0515 16     5.19     5.41\n 100           5.00 0.0515 16     4.89     5.11\n 200           4.89 0.0515 16     4.78     5.00\n\nResults are averaged over the levels of: pH, Activity \nConfidence level used: 0.95 \n\n$contrasts\n contrast                        estimate     SE df t.ratio p.value\n Sorbic.Acid0 - Sorbic.Acid100      0.304 0.0728 16   4.178  0.0019\n Sorbic.Acid0 - Sorbic.Acid200      0.411 0.0728 16   5.653  0.0001\n Sorbic.Acid100 - Sorbic.Acid200    0.107 0.0728 16   1.475  0.3285\n\nResults are averaged over the levels of: pH, Activity \nP value adjustment: tukey method for comparing a family of 3 estimates \n```\n\n\n:::\n:::\n\nIncreased concentrations of sorbic acid result in significant reductions in Salmonella levels. There was a far greater reduction in Salmonella when the the `Sorbic.Acid` was increased from `0` to `100`, compared with `100` to `200`, suggesting that a saturation effect may be occurring.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nemmeans(salm.aov.2, pairwise ~ Activity)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nNOTE: Results may be misleading due to involvement in interactions\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$emmeans\n Activity emmean     SE df lower.CL upper.CL\n 0.78       4.19 0.0664 16     4.05     4.34\n 0.82       4.39 0.0664 16     4.25     4.53\n 0.86       4.79 0.0664 16     4.65     4.93\n 0.9        5.53 0.0664 16     5.39     5.67\n 0.94       6.42 0.0664 16     6.28     6.56\n\nResults are averaged over the levels of: Sorbic.Acid, pH \nConfidence level used: 0.95 \n\n$contrasts\n contrast                    estimate     SE df t.ratio p.value\n Activity0.78 - Activity0.82   -0.192 0.0939 16  -2.046  0.2894\n Activity0.78 - Activity0.86   -0.596 0.0939 16  -6.340  0.0001\n Activity0.78 - Activity0.9    -1.338 0.0939 16 -14.241  <.0001\n Activity0.78 - Activity0.94   -2.223 0.0939 16 -23.669  <.0001\n Activity0.82 - Activity0.86   -0.403 0.0939 16  -4.294  0.0044\n Activity0.82 - Activity0.9    -1.146 0.0939 16 -12.195  <.0001\n Activity0.82 - Activity0.94   -2.031 0.0939 16 -21.622  <.0001\n Activity0.86 - Activity0.9    -0.742 0.0939 16  -7.901  <.0001\n Activity0.86 - Activity0.94   -1.628 0.0939 16 -17.329  <.0001\n Activity0.9 - Activity0.94    -0.886 0.0939 16  -9.427  <.0001\n\nResults are averaged over the levels of: Sorbic.Acid, pH \nP value adjustment: tukey method for comparing a family of 5 estimates \n```\n\n\n:::\n:::\n\nAs the `Activity` increases, the $log_{e}$(Density) of Salmonella increases approximately exponentially, and based on the Tukey Test the increase is significant at each increase in water activity with the exception of between `0.78` and `0.82`.\n:::\n:::\n\n\n## Exercise 2 - More practice\nAn experiment was performed to study the control of potato blight on potatoes.  A factorial treatment structure was employed with 3 Varieties in combination with 5 Chemical treatments.  The experiment was conducted using a randomised complete block design (RCBD) with three blocks.  The response is yield of potatoes (lbs).\n\nProvide graphical summaries of the data, analyse the experiment, conduct any post-hoc tests if the results are significant.  The data is found in the **Potato** sheet in the **Data6.xlsx** file.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#\n```\n:::\n\n\n::: {.content-visible when-profile=\"solution\"}\n::: {.ans}\n### Solution\nFirst we read in the data and convert to `factor` if required.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readxl)\npot<-read_excel(\"data/Data6.xlsx\",sheet=\"Potato\")\nstr(pot)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ntibble [45 × 4] (S3: tbl_df/tbl/data.frame)\n $ Yield   : num [1:45] 34.1 76.3 72.2 51.9 42.9 62.1 66.3 39.1 75.1 41.7 ...\n $ Block   : num [1:45] 1 1 1 2 2 2 3 3 3 1 ...\n $ Variety : chr [1:45] \"Pontiac\" \"Sebago\" \"Sebago\" \"Desire\" ...\n $ Chemical: chr [1:45] \"CuOxy4\" \"Dithane10\" \"Dithane4\" \"CuOxy4\" ...\n```\n\n\n:::\n\n```{.r .cell-code}\npot$Block<-as.factor(pot$Block)\npot$Variety<-as.factor(pot$Variety)\npot$Chemical<-as.factor(pot$Chemical)\nstr(pot)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ntibble [45 × 4] (S3: tbl_df/tbl/data.frame)\n $ Yield   : num [1:45] 34.1 76.3 72.2 51.9 42.9 62.1 66.3 39.1 75.1 41.7 ...\n $ Block   : Factor w/ 3 levels \"1\",\"2\",\"3\": 1 1 1 2 2 2 3 3 3 1 ...\n $ Variety : Factor w/ 3 levels \"Desire\",\"Pontiac\",..: 2 3 3 1 3 2 3 3 1 2 ...\n $ Chemical: Factor w/ 5 levels \"Control\",\"CuOxy10\",..: 3 4 5 3 2 4 4 2 5 5 ...\n```\n\n\n:::\n:::\n\n\nGraphical summaries for the main effects are easier to interpret than summary statistics.\n\nThe boxplots based on `Variety` show that `Pontiac` is the worst performing.\n\n::: {.cell}\n\n```{.r .cell-code}\nboxplot(Yield~Variety,data=pot,main=\" \",xlab=\"Variety\",ylab=\"Yield\")\n```\n\n::: {.cell-output-display}\n![](Lab06-factorial-anova_files/figure-typst/unnamed-chunk-24-1.png)\n:::\n:::\n\n\nThe boxplots for each level of `Chemical` show that `Dithane10` results in the greatest yield.\n\n::: {.cell}\n\n```{.r .cell-code}\nboxplot(Yield~Chemical,data=pot,main=\" \",xlab=\"Chemical\",ylab=\"Yield\")\n```\n\n::: {.cell-output-display}\n![](Lab06-factorial-anova_files/figure-typst/unnamed-chunk-25-1.png)\n:::\n:::\n\n\nThe marginal means below show that applying no chemical (`Control`) to suppress potato blight results in the worse yields for all varieties.  The combination of `Desire` and `Dithane10` result in the greatest yield.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwith(pot, tapply(Yield, list(Chemical=Chemical,Variety=Variety), mean) )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n           Variety\nChemical      Desire  Pontiac   Sebago\n  Control   42.13333 14.83333 36.06667\n  CuOxy10   60.53333 28.96667 45.40000\n  CuOxy4    51.63333 27.80000 40.70000\n  Dithane10 97.10000 65.00000 76.93333\n  Dithane4  70.83333 47.50000 63.80000\n```\n\n\n:::\n:::\n\n\nThe interaction plot below shows the lines to be reasonably parallel so an interaction effect is unlikely.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninteraction.plot(pot$Variety,pot$Chemical,pot$Yield)\n```\n\n::: {.cell-output-display}\n![](Lab06-factorial-anova_files/figure-typst/unnamed-chunk-27-1.png)\n:::\n:::\n\n\nThe residual diagnostics show that the data is normally distributed, has constant variance and has no obvious outliers.\n\n::: {.cell}\n\n```{.r .cell-code}\npot.aov<-aov(Yield~Block+Chemical*Variety,data=pot)\npar(mfrow=c(2,2))\nhist(rstandard(pot.aov))\nplot(pot.aov$fitted.values,(rstandard(pot.aov)))\nqqnorm(rstandard(pot.aov))\nabline(0,1)\n```\n\n::: {.cell-output-display}\n![](Lab06-factorial-anova_files/figure-typst/unnamed-chunk-28-1.png)\n:::\n:::\n\n\n\nor\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#library(performance)\ncheck_model(pot.aov)\n```\n\n::: {.cell-output-display}\n![](Lab06-factorial-anova_files/figure-typst/unnamed-chunk-29-1.png)\n:::\n:::\n\n\n\nThe ANOVA shows that interactions is not significant so we can examine the main effects individually.  Both are significant with P-values less than 0.05.\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(pot.aov)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                 Df Sum Sq Mean Sq F value   Pr(>F)    \nBlock             2    111      55   1.071    0.356    \nChemical          4  13251    3313  64.109 1.09e-13 ***\nVariety           2   5762    2881  55.756 1.72e-10 ***\nChemical:Variety  8    259      32   0.628    0.748    \nResiduals        28   1447      52                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\nTukey Post-hoc tests on the main effects is shown below.\n\n::: {.cell}\n\n```{.r .cell-code}\nemmeans(pot.aov, pairwise ~ Variety)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nNOTE: Results may be misleading due to involvement in interactions\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$emmeans\n Variety emmean   SE df lower.CL upper.CL\n Desire    64.4 1.86 28     60.6     68.2\n Pontiac   36.8 1.86 28     33.0     40.6\n Sebago    52.6 1.86 28     48.8     56.4\n\nResults are averaged over the levels of: Block, Chemical \nConfidence level used: 0.95 \n\n$contrasts\n contrast         estimate   SE df t.ratio p.value\n Desire - Pontiac     27.6 2.62 28  10.525  <.0001\n Desire - Sebago      11.9 2.62 28   4.521  0.0003\n Pontiac - Sebago    -15.8 2.62 28  -6.004  <.0001\n\nResults are averaged over the levels of: Block, Chemical \nP value adjustment: tukey method for comparing a family of 3 estimates \n```\n\n\n:::\n\n```{.r .cell-code}\nplot(emmeans(pot.aov, pairwise ~ Variety), comparisons = TRUE)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nNOTE: Results may be misleading due to involvement in interactions\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Lab06-factorial-anova_files/figure-typst/unnamed-chunk-31-1.png)\n:::\n\n```{.r .cell-code}\nemmeans(pot.aov, pairwise ~ Chemical)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nNOTE: Results may be misleading due to involvement in interactions\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$emmeans\n Chemical  emmean  SE df lower.CL upper.CL\n Control     31.0 2.4 28     26.1     35.9\n CuOxy10     45.0 2.4 28     40.1     49.9\n CuOxy4      40.0 2.4 28     35.1     45.0\n Dithane10   79.7 2.4 28     74.8     84.6\n Dithane4    60.7 2.4 28     55.8     65.6\n\nResults are averaged over the levels of: Block, Variety \nConfidence level used: 0.95 \n\n$contrasts\n contrast             estimate   SE df t.ratio p.value\n Control - CuOxy10      -13.96 3.39 28  -4.118  0.0026\n Control - CuOxy4        -9.03 3.39 28  -2.666  0.0852\n Control - Dithane10    -48.67 3.39 28 -14.362  <.0001\n Control - Dithane4     -29.70 3.39 28  -8.765  <.0001\n CuOxy10 - CuOxy4         4.92 3.39 28   1.453  0.6003\n CuOxy10 - Dithane10    -34.71 3.39 28 -10.243  <.0001\n CuOxy10 - Dithane4     -15.74 3.39 28  -4.646  0.0006\n CuOxy4 - Dithane10     -39.63 3.39 28 -11.696  <.0001\n CuOxy4 - Dithane4      -20.67 3.39 28  -6.099  <.0001\n Dithane10 - Dithane4    18.97 3.39 28   5.597  0.0001\n\nResults are averaged over the levels of: Block, Variety \nP value adjustment: tukey method for comparing a family of 5 estimates \n```\n\n\n:::\n\n```{.r .cell-code}\nplot(emmeans(pot.aov, pairwise ~ Chemical), comparisons = TRUE)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nNOTE: Results may be misleading due to involvement in interactions\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Lab06-factorial-anova_files/figure-typst/unnamed-chunk-31-2.png)\n:::\n:::\n\nThe results are quite clean with one level resulting in significantly greater mean yield for both treatment factors; `Desire` for `Variety` and `Dithane10` for `Chemical`.  From this we would recommend the use of `Desire` and `Dithane10` for maximise yield via supressing potato blight.\n:::\n:::\n\n",
    "supporting": [
      "Lab06-factorial-anova_files/figure-typst"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}