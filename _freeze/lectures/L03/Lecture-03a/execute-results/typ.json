{
  "hash": "f9030dd61e7c820402a0560fb53624e9",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Lecture 03a -- $t$-Tests\nsubtitle: ENVX2001 Applied Statistical Methods\ndate: last-modified\ndate-format: \"MMM YYYY\"\nauthor: Januar Harianto\nformat:\n  ochre-revealjs: default\n  ochre-typst:\n    fig-format: png\nexecute:\n  echo: true\n  warning: false\n  message: false\n---\n\n\n\n# History\n\n## William Gosset (1908)\n\n:::: columns\n::: {.column width=\"40%\"}\n![William Gosset](images/will.png)\n:::\n::: {.column width=\"60%\"}\n- Worked as a statistician at Guinness Brewery in Dublin\n- Published under the pseudonym **\"Student\"** (company policy prevented use of real name)\n- Developed the $t$-distribution and $t$-tests for **small sample sizes**\n- Needed to compare barley varieties with limited data\n:::\n::::\n\n\n## Ronald Fisher (1925)\n\n:::: columns\n::: {.column width=\"40%\"}\n![Ronald Fisher](images/ronald.png)\n:::\n::: {.column width=\"60%\"}\n- Extended and formalised Gosset's work\n- Introduced the concept of **degrees of freedom**\n- Developed **Analysis of Variance (ANOVA)** -- next lecture!\n- Established many foundations of modern statistical inference\n:::\n::::\n\n\n# Cattle data\n\n## The problem\n\n- Weights of two breeds of cattle are to be compared\n- 12 samples were randomly taken from Breed 1, and 15 from Breed 2\n- **Are there differences in the mean weight between the two breeds?**\n\n::: fragment\n\n::: {.cell}\n\n```{.r .cell-code}\ncattle <- read.csv(\"data/cattle.csv\")\ncattle\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Breed1 Breed2\n1   187.6  148.1\n2   180.3  146.2\n3   198.6  152.8\n4   190.7  135.3\n5   196.3  151.2\n6   203.8  146.3\n7   190.2  163.5\n8   201.0  146.6\n9   194.7  162.4\n10  221.1  140.2\n11  186.7  159.4\n12  203.1  181.8\n13     NA  165.1\n14     NA  165.0\n15     NA  141.6\n```\n\n\n:::\n:::\n\n:::\n\n## Reshaping the data\n\nThe data is in **wide** format -- we need to convert it to **long** format for analysis.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncattle <- read.csv(\"data/cattle.csv\") |>\n  pivot_longer(\n    cols = everything(),\n    names_to = \"breed\",\n    values_to = \"weight\"\n  ) |>\n  mutate(breed = as.factor(breed)) |>\n  drop_na()\n\ncattle\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 27 × 2\n   breed  weight\n   <fct>   <dbl>\n 1 Breed1   188.\n 2 Breed2   148.\n 3 Breed1   180.\n 4 Breed2   146.\n 5 Breed1   199.\n 6 Breed2   153.\n 7 Breed1   191.\n 8 Breed2   135.\n 9 Breed1   196.\n10 Breed2   151.\n# ℹ 17 more rows\n```\n\n\n:::\n:::\n\n\n## Visualising the data\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(cattle, aes(breed, weight)) +\n  geom_boxplot() +\n  labs(x = \"Breed\", y = \"Weight (kg)\")\n```\n\n::: {.cell-output-display}\n![](Lecture-03a_files/figure-typst/group_plot-1.png){fig-align='center'}\n:::\n:::\n\n\n\n# Model and hypotheses\n\n## Two-sample $t$-test model\n\nObserved data = Group Mean + Random Error (residuals)\n\n$$y_{ij} = \\mu_i + \\varepsilon_{ij}$$\n\n- $i = 1, 2$ (group); $j = 1, 2, \\ldots, n_i$ (replicate)\n\nIn the cattle example:\n\n- $\\mu_1$ = mean body weight (kg) for Breed 1\n- $\\mu_2$ = mean body weight (kg) for Breed 2\n\n\n## Hypotheses\n\n- **Null hypothesis**: $H_0: \\mu_1 = \\mu_2$\n- **Alternative hypothesis**: $H_1: \\mu_1 \\neq \\mu_2$\n\n::: fragment\n**Test statistic:**\n\n$$t = \\frac{\\bar{y}_1 - \\bar{y}_2}{\\sqrt{s^2\\left(\\frac{1}{n_1} + \\frac{1}{n_2}\\right)}} = \\frac{\\bar{y}_1 - \\bar{y}_2}{SE(\\bar{y}_1 - \\bar{y}_2)} = \\frac{\\Delta \\text{ in mean}}{SE \\text{ of the } \\Delta \\text{ in mean}}$$\n\n**Degrees of freedom**: $n_1 + n_2 - 2$\n:::\n\n\n# $t$-distribution\n\n## Shape changes with degrees of freedom\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"true\"}\nx <- seq(-4, 4, length.out = 300)\n\nt_data <- map_dfr(c(1, 2, 5, 10, 30), function(df) {\n  tibble(x = x, density = dt(x, df), df = paste(\"df =\", df))\n})\n\nnormal_data <- tibble(x = x, density = dnorm(x), df = \"Normal\")\n\nbind_rows(t_data, normal_data) |>\n  mutate(df = fct_relevel(df, \"df = 1\", \"df = 2\", \"df = 5\", \"df = 10\", \"df = 30\", \"Normal\")) |>\n  ggplot(aes(x, density, colour = df, linetype = df)) +\n  geom_line(linewidth = 1) +\n  scale_linetype_manual(values = c(rep(\"solid\", 5), \"dashed\")) +\n  labs(x = \"t\", y = \"Density\", colour = NULL, linetype = NULL) +\n  theme(legend.position = \"right\")\n```\n\n::: {.cell-output-display}\n![](Lecture-03a_files/figure-typst/t_dist_plot-1.png){fig-align='center'}\n:::\n:::\n\n\n::: {.callout-note}\nAs degrees of freedom increase, the $t$-distribution approaches the standard normal distribution.\n:::\n\n\n## One-tailed vs two-tailed tests\n\n![](images/onetwotail.png){fig-align=\"center\"}\n\n- **Two-tailed**: tests for a difference in *either* direction ($\\mu_1 \\neq \\mu_2$)\n- **One-tailed**: tests for a difference in a *specific* direction ($\\mu_1 > \\mu_2$ or $\\mu_1 < \\mu_2$)\n- In most cases, we use **two-tailed** tests unless we have a strong *a priori* reason for one direction.\n\n\n# Manual calculations\n\n## Group means and standard deviations\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncattle_summary <- cattle |>\n  group_by(breed) |>\n  summarise(\n    n = n(),\n    mean_wt = mean(weight, na.rm = TRUE),\n    sd_wt = sd(weight, na.rm = TRUE)\n  )\n\ncattle_summary\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 4\n  breed      n mean_wt sd_wt\n  <fct>  <int>   <dbl> <dbl>\n1 Breed1    12    196.  10.6\n2 Breed2    15    154.  12.3\n```\n\n\n:::\n:::\n\n\n\n## Computing the $t$-statistic\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Extract values\nn1 <- cattle_summary$n[1]\nn2 <- cattle_summary$n[2]\nm1 <- cattle_summary$mean_wt[1]\nm2 <- cattle_summary$mean_wt[2]\ns1 <- cattle_summary$sd_wt[1]\ns2 <- cattle_summary$sd_wt[2]\n\n# Pooled variance\nsp2 <- ((n1 - 1) * s1^2 + (n2 - 1) * s2^2) / (n1 + n2 - 2)\n\n# t-statistic\nt_stat <- (m1 - m2) / sqrt(sp2 * (1/n1 + 1/n2))\nt_stat\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 9.462409\n```\n\n\n:::\n:::\n\n\n::: fragment\n\n::: {.cell}\n\n```{.r .cell-code}\n# Degrees of freedom\ndf <- n1 + n2 - 2\n\n# p-value (two-tailed)\np_val <- 2 * pt(-abs(t_stat), df)\np_val\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 9.663383e-10\n```\n\n\n:::\n:::\n\n:::\n\n\n# Running `t.test()` in R\n\n## The easy way\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(weight ~ breed, data = cattle, var.equal = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tTwo Sample t-test\n\ndata:  weight by breed\nt = 9.4624, df = 25, p-value = 9.663e-10\nalternative hypothesis: true difference in means between group Breed1 and group Breed2 is not equal to 0\n95 percent confidence interval:\n 33.23011 51.71989\nsample estimates:\nmean in group Breed1 mean in group Breed2 \n             196.175              153.700 \n```\n\n\n:::\n:::\n\n\n::: {.callout-tip}\n`var.equal = TRUE` performs the **pooled** (Student's) $t$-test, which assumes equal variances. This matches our manual calculation.\n:::\n\n\n# Assumptions\n\n## Three key assumptions\n\n1. **Equal variances**: $\\sigma_1^2 \\approx \\sigma_2^2$\n2. **Normality**: $\\varepsilon_{ij} \\sim N(0, \\sigma^2)$\n3. **Independence** of observations\n\n## Checking equal variances\n\nThe only difference between the two groups should be the **location of the mean** -- all else should remain the same.\n\nGeneral guide: $\\frac{\\text{larger SD}}{\\text{smaller SD}} < 2.0$\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmax(cattle_summary$sd_wt) / min(cattle_summary$sd_wt)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1.158756\n```\n\n\n:::\n:::\n\n\n::: fragment\nThe ratio is well under 2, so we can assume equal variances.\n:::\n\n\n## Checking normality: visual\n\n\n::: {.cell layout-ncol=\"2\" layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(cattle, aes(breed, weight)) +\n  geom_boxplot() +\n  labs(title = \"Boxplot\", x = \"Breed\", y = \"Weight (kg)\")\n```\n\n::: {.cell-output-display}\n![](Lecture-03a_files/figure-typst/outlier_check-1.png){fig-align='center'}\n:::\n\n```{.r .cell-code}\nggplot(cattle, aes(weight)) +\n  geom_histogram(bins = 8) +\n  labs(title = \"Histogram\", x = \"Weight (kg)\", y = \"Count\")\n```\n\n::: {.cell-output-display}\n![](Lecture-03a_files/figure-typst/outlier_check-2.png){fig-align='center'}\n:::\n:::\n\n\n\n## Checking normality: Shapiro-Wilk test\n\n\n::: {.cell}\n\n```{.r .cell-code}\nshapiro.test(cattle$weight)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  cattle$weight\nW = 0.93704, p-value = 0.103\n```\n\n\n:::\n:::\n\n\n- If $p > 0.05$, the data is **not** significantly different from a normal distribution, *i.e.* we can assume normality.\n\n## What if assumptions are not met?\n\n::: incremental\n- **Equal variances** not met -- use Welch's $t$-test (the default in R's `t.test()` when `var.equal = FALSE`)\n- **Normality** not met -- if $N > 30$, we can often assume normality anyway ([Central Limit Theorem](https://en.wikipedia.org/wiki/Central_limit_theorem))\n- **Independence** not met -- consider a **paired $t$-test** (e.g. before/after measurements on the same subjects)\n:::\n\n\n# Summary\n\n## Key points\n\n::: incremental\n- The **two-sample $t$-test** compares means of two independent groups\n- The test statistic follows a $t$-distribution with $n_1 + n_2 - 2$ degrees of freedom\n- Always check assumptions: **equal variances**, **normality**, **independence**\n- Use `t.test()` in R for quick analysis\n:::\n\n::: fragment\n### Next up\n- What if we have **more than two groups**? We need **ANOVA**!\n:::\n\n\n## Thanks! {.center-h}\n\n### Questions?\n\nThis presentation is based on the [SOLES Quarto reveal.js template][soles-revealjs] and is licensed under a [Creative Commons Attribution 4.0 International License][cc-by].\n\n\n[soles-revealjs]: https://github.com/usyd-soles-edu/soles-revealjs\n[cc-by]: http://creativecommons.org/licenses/by/4.0/\n",
    "supporting": [
      "Lecture-03a_files/figure-typst"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}