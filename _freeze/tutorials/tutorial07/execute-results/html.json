{
  "hash": "0247a98dc983ad1db0498734b498c1cf",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Tutorial 07\"\n# reviewed-by: ACA, 2026\n---\n\n\n\n## Bird abundance\n\nThis is the *same* dataset used in the lecture.\n\nFragmentation of forest habitat has an impact of wildlife abundance. This study looked at the relationship between bird abundance (bird ha^-1^) and the characteristics of forest patches at 56 locations in SE Victoria.\n\nThe predictor variables are:\n\n-   `ALT` Altitude (m)\n-   `YR.ISOL` Year when the patch was isolated (years)\n-   `GRAZE` Grazing (coded 1-5 which is light to heavy)\n-   `AREA` Patch area (ha)\n-   `DIST` Distance to nearest patch (km)\n-   `LDIST` Distance to largest patch (km)\n\nImport the data from the \"Loyn\" tab in the MS Excel file.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readxl)\nloyn <- read_xlsx(\"data/mlr.xlsx\", \"Loyn\")\n```\n:::\n\n\nOften, the first step in model development is to examine the data. This is a good way to get a feel for the data and to identify any issues that may need to be addressed. In this case, we will examine the data using histograms and a correlation matrix.\n\n### Histograms\n\nThere are a breadth of ways to create histograms in R. In each tab below you will find some different ways to create the same plot outputs.\n\n::: panel-tabset\n### `hist()`\n\nThis is a straightforward way to create multiple histograms with `hist()`. The `par()` function is used to arrange the plots on the page. The `mfrow` argument specifies the number of rows and columns of plots.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# par(mfrow=c(3,3))\nhist(loyn$ABUND)\n```\n\n::: {.cell-output-display}\n![](tutorial07_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\nhist(loyn$ALT)\n```\n\n::: {.cell-output-display}\n![](tutorial07_files/figure-html/unnamed-chunk-2-2.png){width=672}\n:::\n\n```{.r .cell-code}\nhist(loyn$YR.ISOL)\n```\n\n::: {.cell-output-display}\n![](tutorial07_files/figure-html/unnamed-chunk-2-3.png){width=672}\n:::\n\n```{.r .cell-code}\nhist(loyn$GRAZE)\n```\n\n::: {.cell-output-display}\n![](tutorial07_files/figure-html/unnamed-chunk-2-4.png){width=672}\n:::\n\n```{.r .cell-code}\nhist(loyn$AREA)\n```\n\n::: {.cell-output-display}\n![](tutorial07_files/figure-html/unnamed-chunk-2-5.png){width=672}\n:::\n\n```{.r .cell-code}\nhist(loyn$DIST)\n```\n\n::: {.cell-output-display}\n![](tutorial07_files/figure-html/unnamed-chunk-2-6.png){width=672}\n:::\n\n```{.r .cell-code}\nhist(loyn$LDIST)\n```\n\n::: {.cell-output-display}\n![](tutorial07_files/figure-html/unnamed-chunk-2-7.png){width=672}\n:::\n\n```{.r .cell-code}\n# par(mfrow=c(1,1))\n```\n:::\n\n\n### `hist.data.frame()` from `Hmisc`\n\nThe `Hmisc` package provides a function `hist.data.frame()` that can be used to create multiple histograms, which can be called by simply using `hist()`. You may need to tweak the `nclass` argument to get the desired number of bins, as the default may not look appropriate.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# install.packages(\"Hmisc\")\nlibrary(Hmisc)\nhist(loyn, nclass = 50)\n```\n:::\n\n\n### `ggplot()`\n\nA more modern approach is to use `ggplot()` with `facet_wrap()` to arrange multiple plots on a single page. To do this, the `pivot_longer()` function from the `tidyr` package is used to reshape the data into a tidy format.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# tidy the data\nloyn_tidy <- pivot_longer(loyn, cols = everything())\n\n# plot\nggplot(loyn_tidy, aes(x = value)) +\n    geom_histogram() +\n    facet_wrap(~name, scales = \"free\") +\n    theme_bw()\n```\n\n::: {.cell-output-display}\n![](tutorial07_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n### `ggplot()` with `dplyr`\n\nHere we use the pipe operator `%>%` from `dplyr` to chain together a series of commands. The pipe operator takes the output of the command on the left and passes it to the command on the right (or below) the pipe. This means that we can create a series of commands that are executed in order.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nloyn %>%\n    pivot_longer(cols = everything()) %>%\n    ggplot(aes(x = value)) +\n    geom_histogram() +\n    facet_wrap(~name, scales = \"free\") +\n    theme_bw()\n```\n\n::: {.cell-output-display}\n![](tutorial07_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n:::\n\n::: question\n### Question 1\n\nComment on the histograms in terms of leverage. *Hint: what is the relationship between leverage and skewness?*\n:::\n\n::: {.content-visible when-profile=\"solution\"}\n### Answer {style=\"color:green;\"}\n\nThe histograms of `AREA`, `DIST` and `LDIST` are very skewed. The high values would have high leverage, this means that these would cause the residuals to be skewed. These would be candidates for transformation.\n:::\n\n### Correlation matrix\n\nCalculate the correlation matrix using `cor(Loyn)`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncor(loyn)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n              ABUND         AREA      YR.ISOL       DIST       LDIST\nABUND    1.00000000  0.255970206  0.503357741  0.2361125  0.08715258\nAREA     0.25597021  1.000000000 -0.001494192  0.1083429  0.03458035\nYR.ISOL  0.50335774 -0.001494192  1.000000000  0.1132175 -0.08331686\nDIST     0.23611248  0.108342870  0.113217524  1.0000000  0.31717234\nLDIST    0.08715258  0.034580346 -0.083316857  0.3171723  1.00000000\nGRAZE   -0.68251138 -0.310402417 -0.635567104 -0.2558418 -0.02800944\nALT      0.38583617  0.387753885  0.232715406 -0.1101125 -0.30602220\n              GRAZE        ALT\nABUND   -0.68251138  0.3858362\nAREA    -0.31040242  0.3877539\nYR.ISOL -0.63556710  0.2327154\nDIST    -0.25584182 -0.1101125\nLDIST   -0.02800944 -0.3060222\nGRAZE    1.00000000 -0.4071671\nALT     -0.40716705  1.0000000\n```\n\n\n:::\n:::\n\n\n::: question\n### Question 2\n\nWhich independent variables are useful for predicting the dependent variable abundance? Is there evidence for multi-collinearity?\n:::\n\n\n::: {.cell}\n\n:::\n\n\n::: {.content-visible when-profile=\"solution\"}\n### Answer {style=\"color:green;\"}\n\nSome of the predictors are useful, but AREA has a low r.\n\nThe correlation between `GRAZE` and `YR.ISOL` is quite high (r = -0.63556710), suggesting multi-collinearity which may influence the model. If the relationship between these two variables was stronger, we would remove one of the variables to prevent this collinearity from affecting the model.\n\n*Note: For more information on collinearity and how it may impact the model, see Quinn & Keough p 127.*\n:::\n\n### Plotting correlation\n\nExamine correlations visually using `pairs()` or `corrplot()` from the `corrplot` package.\n\n::: panel-tabset\n### Scatterplot matrix\n\n\n::: {.cell}\n\n```{.r .cell-code}\npairs(loyn)\n```\n\n::: {.cell-output-display}\n![](tutorial07_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n### Correlation matrix\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(corrplot)\ncorrplot(cor(loyn))\n```\n\n::: {.cell-output-display}\n![](tutorial07_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n:::\n\n::: question\n### Question 3\n\nAre there any trends visible from the plots?\n:::\n\n::: {.content-visible when-profile=\"solution\"}\n### Answer {style=\"color:green;\"}\n\nNot really; the pairs plot reflects the strength of the linear relationship between each of the variables. There may be some stronger relationships occurring, but it is evident a few of the variables are skewed so it is harder to distinguish within the plots.\n:::\n\n::: callout-tip\nWe can also bring in variance inflation factors (VIF) to help us identify multi-collinearity, but that is done only after we have selected a model.\n:::\n\n### Transformations\n\nThe AREA predictor has a small number of observations with very large values. Apply a log~10~ transformation and label the new variable `Loyn$L10AREA`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nloyn$L10AREA <- log10(loyn$AREA)\n```\n:::\n\n\n::: question\n### Question 4\n\nWhy are we transforming AREA?\n:::\n\n::: {.content-visible when-profile=\"solution\"}\n### Answer {style=\"color:green;\"}\n\nYou do this to stabilise the variance of the regression to manage the leverage of the outliers in the variable. This reduces the skew. L10AREA is more likely to be a significant predictor.\n:::\n\n::: question\n### Question 5\n\nRe-run `pairs(Loyn)` and create a histogram using the transformed value of AREA, how do the plots look?\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhist(loyn$L10AREA)\npairs(loyn)\n```\n:::\n\n\n::: {.content-visible when-profile=\"solution\"}\n### Answer {style=\"color:green;\"}\n\n-   Histogram looks better, less skewed\n-   Pairs plot shows a trend between ABUND and L10AREA\n:::\n\n::: question\n### Question 6\n\nIn preparation for modelling, transform the remaining skewed variables, DIST and LDIST the same way you did for AREA and examine the histogram and pairs plots using these new variables.\n:::\n\nMake sure you end up with two new variables labelled `loyn$L10DIST` and `loyn$L10LDIST`.\n\n\n\n::: {.content-visible when-profile=\"solution\"}\n### Answer {style=\"color:green;\"}\n\nHistogram for both look better, less skewed Pairs plot shows potential trend between ABUND and L10DIST, and ABUND with L10LDIST compared to untransformed DIST and LDIST\n:::",
    "supporting": [
      "tutorial07_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}