{
  "hash": "d977f8620859422111635f624254a138",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Tutorial 08\"\n# reviewed-by: ACA, 2026\n---\n\n\n\n## Exercise 1: Backward elimination in R\n\nData:  *Dippers* spreadsheet\n\n\n[Dippers](https://en.wikipedia.org/wiki/Dipper) are thrush-sized birds living mainly in the upper reaches of rivers, which feed on benthic invertebrates by probing the river beds with their beaks. The dataset in this exercise contains data from a biological survey which examined the nature of the variables thought to influence the breeding of British dippers. \n\nTwenty-two sites were included in the survey. Some of the variables have been transformed. \n\nThe variables measured were:  \n\n- `Altitude` site altitude\n- `Hardness` water hardness\n- `RiverSlope` river-bed slope\n- `LogCadd` the numbers of caddis fly larvae, transformed\n- `LogStone` the numbers of stonefly larvae, transformed\n- `LogMay` the numbers of mayfly larvae, transformed\n- `LogOther` the numbers of all other invertebrates collected, transformed\n- `Br_Dens` the number of breeding pairs of dippers per 10 km of river  \n\nIn the analyses, the four invertebrate variables were transformed using a $log(x+1)$ transformation.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readxl)\nDippers <- read_xlsx(\"data/mlr.xlsx\" , sheet = \"Dippers\")\nglimpse(Dippers)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 22\nColumns: 8\n$ Altitude   <dbl> 259, 198, 251, 184, 145, 145, 198, 160, 251, 159, 160, 145,…\n$ Hardness   <dbl> 12.20, 22.00, 26.30, 22.50, 29.50, 39.90, 42.80, 59.60, 69.…\n$ RiverSlope <dbl> 10.90, 14.70, 6.90, 4.60, 1.91, 5.00, 6.20, 14.30, 4.60, 3.…\n$ Br_Dens    <dbl> 3.60, 4.30, 3.80, 3.40, 3.80, 4.50, 4.30, 5.00, 4.50, 3.40,…\n$ LogCadd    <dbl> 2.303, 2.890, 3.784, 4.419, 3.219, 3.932, 3.664, 4.431, 3.7…\n$ LogStone   <dbl> 5.242, 4.344, 5.231, 5.242, 3.829, 4.898, 4.357, 6.337, 5.4…\n$ LogMay     <dbl> 0.000, 3.401, 5.826, 5.749, 5.509, 5.749, 5.371, 0.000, 4.8…\n$ LogOther   <dbl> 1.386, 1.609, 1.386, 1.386, 1.099, 3.045, 1.386, 2.944, 2.5…\n```\n\n\n:::\n:::\n\n\nYou may explore the data on your own (hint: look at last week's exercise on histogram and scatterplot matrices).\n\n::: {.content-visible when-profile=\"solution\"}\n\n::: {.cell}\n\n```{.r .cell-code}\npairs(Dippers)\n```\n\n::: {.cell-output-display}\n![](tutorial08_files/figure-typst/unnamed-chunk-1-1.png)\n:::\n\n```{.r .cell-code}\ncor(Dippers)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n              Altitude    Hardness  RiverSlope    Br_Dens   LogCadd    LogStone\nAltitude    1.00000000 -0.08170082  0.49003652  0.4063535 0.1807820  0.47736562\nHardness   -0.08170082  1.00000000  0.24208735  0.3503482 0.3337586  0.02951218\nRiverSlope  0.49003652  0.24208735  1.00000000  0.7102216 0.4313081  0.57479242\nBr_Dens     0.40635349  0.35034817  0.71022164  1.0000000 0.6126891  0.76294367\nLogCadd     0.18078205  0.33375857  0.43130806  0.6126891 1.0000000  0.44347440\nLogStone    0.47736562  0.02951218  0.57479242  0.7629437 0.4434744  1.00000000\nLogMay     -0.12782013  0.41356844 -0.09616686  0.1562659 0.4378978 -0.16744101\nLogOther   -0.33859788  0.55399249 -0.02007183 -0.1277591 0.3521440 -0.30025225\n                LogMay    LogOther\nAltitude   -0.12782013 -0.33859788\nHardness    0.41356844  0.55399249\nRiverSlope -0.09616686 -0.02007183\nBr_Dens     0.15626585 -0.12775913\nLogCadd     0.43789780  0.35214400\nLogStone   -0.16744101 -0.30025225\nLogMay      1.00000000  0.38820063\nLogOther    0.38820063  1.00000000\n```\n\n\n:::\n:::\n\n\n:::\n\nWhen ready, perform a backward elimination starting from the full model: \n\n\n::: {.cell}\n\n```{.r .cell-code}\nFullMod <- lm(Br_Dens ~ ., data=Dippers)\nRedMod <- step(FullMod, direction = \"backward\")\nsummary(FullMod)\nsummary(RedMod)\nAIC(FullMod, RedMod)\n```\n:::\n\n\n:::{.question}\n### Question 1\n\nWhich model is chosen? Why?\n:::\n\n::: {.content-visible when-profile=\"solution\"}\n### Answer {style=\"color:green;\"}\n\nThe reduced model is chosen as it is better and has the lower AIC. In addition, the adjusted *r*^2^ is higher for the reduced model, indicating that the reduced model is a better fit to the data. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nFullMod <- lm(Br_Dens ~ ., data=Dippers)\nRedMod <- step(FullMod, direction = \"backward\", trace = 0) # backward selection\n\n# Plot as table (a good trick for reports!)\ncompare <- AIC(FullMod, RedMod) %>% # get AIC data frame\n  # then, add adjusted r-squared values in a new column using `mutate()`\n  mutate(adj_r2 = c(summary(FullMod)$adj.r.squared, summary(RedMod)$adj.r.squared)) %>%\n  # then, round all numeric values to 2 decimal places\n  mutate(across(where(is.numeric), \\(x) round(x, 2)))\n\nknitr::kable(compare)\n```\n\n::: {.cell-output-display}\n\n\n|        | df|   AIC| adj_r2|\n|:-------|--:|-----:|------:|\n|FullMod |  9| 56.08|   0.76|\n|RedMod  |  7| 53.92|   0.78|\n\n\n:::\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(FullMod)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = Br_Dens ~ ., data = Dippers)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-1.24313 -0.38686  0.06925  0.42252  1.19902 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)  \n(Intercept) -0.881054   1.215055  -0.725   0.4803  \nAltitude    -0.001801   0.003537  -0.509   0.6186  \nHardness     0.009956   0.004961   2.007   0.0645 .\nRiverSlope   0.080254   0.035781   2.243   0.0416 *\nLogCadd      0.408917   0.274412   1.490   0.1584  \nLogStone     0.604083   0.249207   2.424   0.0295 *\nLogMay       0.114607   0.114116   1.004   0.3323  \nLogOther    -0.267073   0.131828  -2.026   0.0623 .\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.7208 on 14 degrees of freedom\nMultiple R-squared:  0.8433,\tAdjusted R-squared:  0.765 \nF-statistic: 10.77 on 7 and 14 DF,  p-value: 0.0001085\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(RedMod)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = Br_Dens ~ Hardness + RiverSlope + LogCadd + LogStone + \n    LogOther, data = Dippers)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-1.18190 -0.49120 -0.08373  0.41721  1.31073 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)  \n(Intercept) -0.724619   1.028416  -0.705   0.4912  \nHardness     0.011811   0.004519   2.613   0.0188 *\nRiverSlope   0.065384   0.031545   2.073   0.0547 .\nLogCadd      0.548799   0.226169   2.426   0.0274 *\nLogStone     0.512494   0.229020   2.238   0.0398 *\nLogOther    -0.268128   0.123932  -2.164   0.0460 *\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.7029 on 16 degrees of freedom\nMultiple R-squared:  0.8297,\tAdjusted R-squared:  0.7765 \nF-statistic: 15.59 on 5 and 16 DF,  p-value: 1.169e-05\n```\n\n\n:::\n\n```{.r .cell-code}\nAIC(FullMod, RedMod)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        df      AIC\nFullMod  9 56.08470\nRedMod   7 53.91655\n```\n\n\n:::\n:::\n\n\n:::\n",
    "supporting": [
      "tutorial08_files/figure-typst"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}