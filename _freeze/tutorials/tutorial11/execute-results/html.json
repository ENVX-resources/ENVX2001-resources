{
  "hash": "0e32660ee8349fdbc5d47db7db9a8cbe",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Tutorial 11: Clustering\"\n# reviewed-by:\n---\n\n\n\n# Dissimilarity Matrices and Clustering\n\nWe are going to analyse the bird assemblage data from the lecture.\n\n## Setup\n\nLoad the vegan package:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(vegan)\n```\n:::\n\n\n## Load the data\n\nRead the data:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmacnally <- read.csv(\"data/macnally.csv\", row.names = 1)\nhead(macnally, 1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n           HABITAT V1GST V2EYR V3GF V4BTH V5GWH V6WTTR V7WEHE V8WNHE V9SFW\nReedy Lake   Mixed   3.4     0    0     0     0      0      0   11.9   0.4\n           V10WBSW V11CR V12LK V13RWB V14AUR V15STTH V16LR V17WPHE V18YTH V19ER\nReedy Lake       0   1.1   3.8    9.7      0       0   4.8    27.3      0   5.1\n           V20PCU V21ESP V22SCR V23RBFT V24BFCS V25WAG V26WWCH V27NHHE V28VS\nReedy Lake      0      0      0       0     0.6    1.9       0       0     0\n           V29CST V30BTR V31AMAG V32SCC V33RWH V34WSW V35STP V36YFHE V37WHIP\nReedy Lake    1.7   12.5     8.6   12.5    0.6      0    4.8       0       0\n           V38GAL V39FHE V40BRTH V41SPP V42SIL V43GCU V44MUSK V45MGLK V46BHHE\nReedy Lake    4.8   26.2       0      0      0      0    13.1     1.7     1.1\n           V47RFC V48YTBC V49LYRE V50CHE V51OWH V52TRM V53MB V54STHR V55LHE\nReedy Lake      0       0       0      0      0     15     0       0      0\n           V56FTC V57PINK V58OBO V59YR V60LFB V61SPW V62RBTR V63DWS V64BELL\nReedy Lake      0       0      0     0    2.9      0       0    0.4       0\n           V65LWB V66CBW V67GGC V68PIL V69SKF V70RSL V71PDOV V72CRP V73JW\nReedy Lake      0      0      0      0    1.9    6.7       0      0     0\n           V74BCHE V75RCR V76GBB V77RRP V78LLOR V79YTHE V80RF V81SHBC V82AZKF\nReedy Lake       0      0      0    4.8       0       0     0       0       0\n           V83SFC V84YRTH V85ROSE V86BCOO V87LFC V88WG V89PCOO V90WTG V91NMIN\nReedy Lake      0       0       0       0      0     0     1.9      0     0.2\n           V92NFB V93DB V94RBEE V95HBC V96DF V97PCL V98FLAME V99WWT V100WBWS\nReedy Lake      0     0       0      0     0    9.1        0      0        0\n           V101LCOR V102KING\nReedy Lake        0        0\n```\n\n\n:::\n:::\n\n\n## Calculate Bray-Curtis Dissimilarity\n\nCalculate the Bray-Curtis dissimilarity:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nBraydistance <- vegdist(macnally[, 3:102])\n```\n:::\n\n\n## Hierarchical Clustering\n\nApply hierarchical clustering using the UPGMA method (\"average\"):\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhc <- hclust(Braydistance, method = \"average\")\n```\n:::\n\n\n## Plot the Dendrogram\n\nPlot the dendrogram:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(hc)\n```\n\n::: {.cell-output-display}\n![](tutorial11_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nLet's add some labels, and look at the potential number of clusters:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(hc, las = 1, \n     main = \"Cluster diagram of Bird Assemblages\",\n     xlab = \"Site\", \n     ylab = \"Bray-Curtis Dissimilarity\")\nrect.hclust(hc, 2, border = \"red\")\nrect.hclust(hc, 5, border = \"darkgreen\")\n```\n\n::: {.cell-output-display}\n![](tutorial11_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\nThe rectangles show potential groupings at different levels of the dendrogram:\n\n- **Red rectangles**: 2 clusters\n- **Green rectangles**: 5 clusters\n\nThe choice of how many clusters to use depends on your research question and the level of dissimilarity that is meaningful for your study.\n",
    "supporting": [
      "tutorial11_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}